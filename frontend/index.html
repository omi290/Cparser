<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>C Parser Visualizer ‚Äî Phase 2: Syntax Analysis</title>
  <meta name="description"
    content="Interactive C language parser ‚Äî lexical tokenizer and syntax tree visualizer with pipeline visualization." />
  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <!-- ‚ïê‚ïê‚ïê NAVBAR ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <nav class="navbar">
    <div class="nav-brand">
      <div class="nav-logo">C</div>
      <div>
        <div class="nav-title">C Parser Visualizer</div>
        <div class="nav-subtitle">Educational Compiler Tool ‚Äî Phase 2</div>
      </div>
    </div>

    <div class="nav-right">
      <div class="nav-badges">
        <span class="badge badge-live">API Live</span>
      </div>
      <button class="theme-toggle" id="theme-toggle" title="Toggle dark / light mode" aria-label="Toggle theme">
        <div class="theme-toggle-knob">
          <span class="theme-toggle-icon" id="theme-icon">üåô</span>
        </div>
      </button>
    </div>
  </nav>

  <!-- ‚ïê‚ïê‚ïê MAIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <main class="main">

    <!-- Hero -->
    <div class="hero">
      <h2>Tokenize, Parse &amp; Visualize C Code</h2>
      <p>Enter C code, click <strong>Analyze</strong> ‚Äî see the full compilation pipeline from source to AST.</p>
    </div>

    <!-- Pipeline banner -->
    <div class="pipeline-bar">
      <div class="pipeline-step" id="pip-source">
        <span class="pip-icon">üìÑ</span>
        <span>Source Code</span>
      </div>
      <span class="pip-arrow">‚Üí</span>
      <div class="pipeline-step" id="pip-lex">
        <span class="pip-icon">üî§</span>
        <span>Lexical Analysis</span>
      </div>
      <span class="pip-arrow">‚Üí</span>
      <div class="pipeline-step" id="pip-parse">
        <span class="pip-icon">‚öôÔ∏è</span>
        <span>Syntax Parser</span>
      </div>
      <span class="pip-arrow">‚Üí</span>
      <div class="pipeline-step" id="pip-ast">
        <span class="pip-icon">üå≥</span>
        <span>AST</span>
      </div>
    </div>

    <!-- Two-column grid -->
    <div class="grid">

      <!-- ‚îÄ‚îÄ‚îÄ LEFT: Code Editor ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">
            <div class="card-title-icon">‚å®Ô∏è</div>
            Code Editor
          </div>
          <span class="card-label">C Language</span>
        </div>

        <!-- Editor chrome -->
        <div class="editor-wrap">
          <div class="editor-toolbar">
            <span class="editor-dot red"></span>
            <span class="editor-dot yellow"></span>
            <span class="editor-dot green"></span>
            <span class="editor-filename">main.c</span>
          </div>
          <textarea id="code-input" spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off"
            placeholder="// Enter C code here or click a sample below‚Ä¶"></textarea>
          <!-- Error line indicator -->
          <div id="error-line-indicator" class="error-line-indicator" style="display:none;">
            <span class="err-line-icon">‚ùå</span>
            <span id="err-line-text"></span>
          </div>
        </div>

        <!-- Footer meta -->
        <div class="editor-footer">
          <span>Supports: declarations ¬∑ if-else ¬∑ while ¬∑ printf ¬∑ scanf ¬∑ expressions</span>
          <span><span id="char-count">0 chars</span> ¬∑ <span id="line-count">0 lines</span></span>
        </div>

        <!-- Sample code buttons -->
        <div class="sample-btn-row">
          <span class="sample-label">Samples:</span>
          <button class="sample-btn" data-sample="valid">‚úÖ Valid</button>
          <button class="sample-btn" data-sample="ifelse">‚ÜîÔ∏è If-Else</button>
          <button class="sample-btn" data-sample="while">üîÅ While</button>
          <button class="sample-btn" data-sample="printf">üì¢ Printf</button>
          <button class="sample-btn" data-sample="error">‚ö†Ô∏è Error</button>
        </div>

        <!-- Action buttons -->
        <div class="btn-row">
          <button id="analyze-btn" class="btn btn-primary">
            <div class="spinner"></div>
            <svg class="btn-icon" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"
              viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
            </svg>
            <span class="btn-text">Analyze</span>
          </button>
          <button id="clear-btn" class="btn btn-secondary" title="Clear editor">
            <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
            Clear
          </button>
        </div>

        <p style="font-size:0.7rem;color:var(--text-muted);margin-top:0.4rem;text-align:right;">
          <kbd
            style="background:var(--bg-tertiary);border:1px solid var(--border);border-radius:4px;padding:0.1rem 0.35rem;font-family:'JetBrains Mono',monospace;font-size:0.68rem;">Ctrl+Enter</kbd>
          to analyze
        </p>

        <!-- Banners -->
        <div id="error-banner" class="banner banner-error">
          <span class="banner-icon">‚ö†Ô∏è</span>
          <span id="error-msg"></span>
        </div>
        <div id="success-banner" class="banner banner-success">
          <span class="banner-icon">‚úÖ</span>
          <span id="success-msg"></span>
        </div>
      </div>

      <!-- ‚îÄ‚îÄ‚îÄ RIGHT: Visualization Panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      <div class="card viz-card">
        <div class="card-header">
          <div class="card-title">
            <div class="card-title-icon">üìä</div>
            Visualization
          </div>
          <button id="copy-btn" class="copy-btn" title="Copy tokens as text">
            <svg width="12" height="12" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
              <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" />
            </svg>
            <span class="copy-text">Copy</span>
          </button>
        </div>

        <!-- Tab bar -->
        <div class="tabs" role="tablist">
          <button class="tab-btn active" data-tab="tokens" role="tab" aria-selected="true">
            üî§ Lexical Analysis
          </button>
          <button class="tab-btn" data-tab="syntax" role="tab" aria-selected="false">
            üå≥ Syntax Analyzer
          </button>
        </div>

        <!-- ‚îÄ‚îÄ Panel: Lexical Analysis ‚îÄ‚îÄ -->
        <div id="panel-tokens" class="tab-panel active">

          <div id="stats-row" class="stats-row" style="display:none;"></div>

          <div id="table-wrap" class="table-wrap" style="display:none;">
            <table class="token-table">
              <thead>
                <tr>
                  <th class="col-num">#</th>
                  <th>Token Type</th>
                  <th>Value</th>
                  <th class="col-line">Line</th>
                </tr>
              </thead>
              <tbody id="token-tbody"></tbody>
            </table>
          </div>

          <div id="empty-state" class="empty-state">
            <div class="empty-icon">üîç</div>
            <p>No tokens yet</p>
            <small>Click a sample or write code, then click "Analyze"</small>
          </div>

          <div id="stream-section" style="display:none;">
            <div class="card-header" style="margin-top:1.25rem;margin-bottom:0.5rem;">
              <div class="card-title" style="font-size:0.875rem;">
                <div class="card-title-icon" style="font-size:0.75rem;">üé®</div>
                Colored Token Stream
              </div>
            </div>
            <div id="stream-box" class="stream-box"></div>

            <div class="legend">
              <div class="legend-item"><span class="legend-dot" style="background:var(--tok-keyword)"></span>Keywords
              </div>
              <div class="legend-item"><span class="legend-dot"
                  style="background:var(--tok-identifier)"></span>Identifiers</div>
              <div class="legend-item"><span class="legend-dot" style="background:var(--tok-number)"></span>Numbers
              </div>
              <div class="legend-item"><span class="legend-dot" style="background:var(--tok-operator)"></span>Operators
              </div>
              <div class="legend-item"><span class="legend-dot"
                  style="background:var(--tok-separator)"></span>Separators</div>
              <div class="legend-item"><span class="legend-dot" style="background:var(--tok-string)"></span>Strings
              </div>
            </div>
          </div>
        </div>

        <!-- ‚îÄ‚îÄ Panel: Syntax Analyzer ‚îÄ‚îÄ -->
        <div id="panel-syntax" class="tab-panel">

          <!-- Structured error box -->
          <div id="parse-error-box" class="parse-error-box" style="display:none;"></div>

          <!-- Collapsible Grammar panel -->
          <div class="grammar-panel">
            <button class="grammar-toggle" id="grammar-toggle" aria-expanded="false">
              <span>üìñ Supported Grammar</span>
              <span class="grammar-arrow">‚ñ∂</span>
            </button>
            <div class="grammar-body" id="grammar-body" style="display:none;">
              <table class="grammar-table">
                <thead>
                  <tr>
                    <th>Rule</th>
                    <th>Production</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Declaration</td>
                    <td><code>TYPE IDENTIFIER ;</code></td>
                  </tr>
                  <tr>
                    <td>Init Decl</td>
                    <td><code>TYPE IDENTIFIER = expression ;</code></td>
                  </tr>
                  <tr>
                    <td>Assignment</td>
                    <td><code>IDENTIFIER = expression ;</code></td>
                  </tr>
                  <tr>
                    <td>IfStmt</td>
                    <td><code>if ( expr ) { stmts } else { stmts }</code></td>
                  </tr>
                  <tr>
                    <td>WhileStmt</td>
                    <td><code>while ( expr ) { stmts }</code></td>
                  </tr>
                  <tr>
                    <td>Printf</td>
                    <td><code>printf ( "format" , args ) ;</code></td>
                  </tr>
                  <tr>
                    <td>Scanf</td>
                    <td><code>scanf ( "format" , &amp;id ) ;</code></td>
                  </tr>
                  <tr>
                    <td>Return</td>
                    <td><code>return expression ;</code></td>
                  </tr>
                  <tr>
                    <td>Expression</td>
                    <td><code>comparison ‚Üí additive ‚Üí term ‚Üí factor</code></td>
                  </tr>
                  <tr>
                    <td>Comparison</td>
                    <td><code>expr ( == | != | &lt; | &gt; | &lt;= | &gt;= ) expr</code></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- AST area -->
          <div id="ast-empty" class="empty-state">
            <div class="empty-icon">üå≥</div>
            <p>No parse tree yet</p>
            <small>Click "Analyze" to build the syntax tree</small>
          </div>

          <div id="ast-container" class="ast-container" style="display:none;">
            <div class="ast-legend">
              <span class="ast-legend-label">Node types:</span>
              <span class="ast-badge node-Program">Program</span>
              <span class="ast-badge node-VarDecl">VarDecl</span>
              <span class="ast-badge node-Assign">Assign</span>
              <span class="ast-badge node-If">If</span>
              <span class="ast-badge node-While">While</span>
              <span class="ast-badge node-Printf">Printf</span>
              <span class="ast-badge node-Scanf">Scanf</span>
              <span class="ast-badge node-BinaryOp">BinaryOp</span>
              <span class="ast-badge node-expr">Leaf</span>
            </div>
            <div id="ast-tree" class="ast-tree"></div>
          </div>

          <!-- Parser Trace -->
          <div class="trace-panel">
            <button class="trace-toggle" id="trace-toggle" aria-expanded="false">
              <span>üîé Parser Trace</span>
              <span class="trace-arrow">‚ñ∂</span>
            </button>
            <div class="trace-body" id="trace-body" style="display:none;">
              <pre id="trace-content" class="trace-content">Run an analysis to see parser steps‚Ä¶</pre>
            </div>
          </div>

        </div><!-- /panel-syntax -->
      </div><!-- /right card -->
    </div><!-- /grid -->
  </main>

  <script src="app.js"></script>

  <script>
    /* ‚îÄ‚îÄ Theme toggle ‚îÄ‚îÄ */
    const _html = document.documentElement;
    const _toggle = document.getElementById('theme-toggle');
    const _themeIcon = document.getElementById('theme-icon');

    function applyTheme(theme) {
      _html.setAttribute('data-theme', theme);
      _themeIcon.textContent = theme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
      localStorage.setItem('cparser-theme', theme);
    }

    const saved = localStorage.getItem('cparser-theme') || 'dark';
    applyTheme(saved);

    _toggle.addEventListener('click', () => {
      applyTheme(_html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
    });

    /* ‚îÄ‚îÄ Grammar panel toggle ‚îÄ‚îÄ */
    const grammarToggle = document.getElementById('grammar-toggle');
    const grammarBody = document.getElementById('grammar-body');
    const grammarArrow = grammarToggle.querySelector('.grammar-arrow');

    grammarToggle.addEventListener('click', () => {
      const open = grammarBody.style.display === 'none';
      grammarBody.style.display = open ? 'block' : 'none';
      grammarArrow.textContent = open ? '‚ñº' : '‚ñ∂';
      grammarToggle.setAttribute('aria-expanded', open);
    });

    /* ‚îÄ‚îÄ Trace panel toggle ‚îÄ‚îÄ */
    const traceToggle = document.getElementById('trace-toggle');
    const traceBody = document.getElementById('trace-body');
    const traceArrow = traceToggle.querySelector('.trace-arrow');

    traceToggle.addEventListener('click', () => {
      const open = traceBody.style.display === 'none';
      traceBody.style.display = open ? 'block' : 'none';
      traceArrow.textContent = open ? '‚ñº' : '‚ñ∂';
      traceToggle.setAttribute('aria-expanded', open);
    });
  </script>

</body>

</html>